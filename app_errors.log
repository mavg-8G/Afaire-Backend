2025-06-05 18:51:11,228 - error_handlers - ERROR - Detailed error logged: {'error_id': '2df11076', 'timestamp': '2025-06-05T18:51:11.226093', 'error_type': 'RequestValidationError', 'error_message': '[{\'type\': \'value_error\', \'loc\': (\'body\', \'username\'), \'msg\': \'Value error, Username can only contain letters, numbers, underscores, and hyphens\', \'input\': "\'; DROP TABLE users; --", \'ctx\': {\'error\': ValueError(\'Username can only contain letters, numbers, underscores, and hyphens\')}}, {\'type\': \'string_too_short\', \'loc\': (\'body\', \'password\'), \'msg\': \'String should have at least 8 characters\', \'input\': \'weak\', \'ctx\': {\'min_length\': 8}}, {\'type\': \'bool_parsing\', \'loc\': (\'body\', \'is_admin\'), \'msg\': \'Input should be a valid boolean, unable to interpret input\', \'input\': \'not_a_boolean\'}]', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 346, in app\n    raise validation_error\nfastapi.exceptions.RequestValidationError: [{\'type\': \'value_error\', \'loc\': (\'body\', \'username\'), \'msg\': \'Value error, Username can only contain letters, numbers, underscores, and hyphens\', \'input\': "\'; DROP TABLE users; --", \'ctx\': {\'error\': ValueError(\'Username can only contain letters, numbers, underscores, and hyphens\')}}, {\'type\': \'string_too_short\', \'loc\': (\'body\', \'password\'), \'msg\': \'String should have at least 8 characters\', \'input\': \'weak\', \'ctx\': {\'min_length\': 8}}, {\'type\': \'bool_parsing\', \'loc\': (\'body\', \'is_admin\'), \'msg\': \'Input should be a valid boolean, unable to interpret input\', \'input\': \'not_a_boolean\'}]\n', 'user_id': None, 'additional_context': {'error_category': 'validation', 'validation_errors': [{'type': 'value_error', 'loc': ('body', 'username'), 'msg': 'Value error, Username can only contain letters, numbers, underscores, and hyphens', 'input': "'; DROP TABLE users; --", 'ctx': {'error': ValueError('Username can only contain letters, numbers, underscores, and hyphens')}}, {'type': 'string_too_short', 'loc': ('body', 'password'), 'msg': 'String should have at least 8 characters', 'input': 'weak', 'ctx': {'min_length': 8}}, {'type': 'bool_parsing', 'loc': ('body', 'is_admin'), 'msg': 'Input should be a valid boolean, unable to interpret input', 'input': 'not_a_boolean'}]}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '129', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:51:11,240 - error_handlers - ERROR - Detailed error logged: {'error_id': '2b30831f', 'timestamp': '2025-06-05T18:51:11.240405', 'error_type': 'RequestValidationError', 'error_message': '[{\'type\': \'string_type\', \'loc\': (\'body\', \'title\'), \'msg\': \'Input should be a valid string\', \'input\': 123}, {\'type\': \'datetime_from_date_parsing\', \'loc\': (\'body\', \'start_date\'), \'msg\': \'Input should be a valid datetime or date, invalid character in year\', \'input\': \'not_a_date\', \'ctx\': {\'error\': \'invalid character in year\'}}, {\'type\': \'value_error\', \'loc\': (\'body\', \'time\'), \'msg\': \'Value error, Time must be in HH:MM format (24-hour)\', \'input\': \'25:99\', \'ctx\': {\'error\': ValueError(\'Time must be in HH:MM format (24-hour)\')}}, {\'type\': \'int_parsing\', \'loc\': (\'body\', \'category_id\'), \'msg\': \'Input should be a valid integer, unable to parse string as an integer\', \'input\': \'not_an_integer\'}, {\'type\': \'enum\', \'loc\': (\'body\', \'mode\'), \'msg\': "Input should be \'personal\', \'work\' or \'both\'", \'input\': \'invalid_mode\', \'ctx\': {\'expected\': "\'personal\', \'work\' or \'both\'"}}]', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 346, in app\n    raise validation_error\nfastapi.exceptions.RequestValidationError: [{\'type\': \'string_type\', \'loc\': (\'body\', \'title\'), \'msg\': \'Input should be a valid string\', \'input\': 123}, {\'type\': \'datetime_from_date_parsing\', \'loc\': (\'body\', \'start_date\'), \'msg\': \'Input should be a valid datetime or date, invalid character in year\', \'input\': \'not_a_date\', \'ctx\': {\'error\': \'invalid character in year\'}}, {\'type\': \'value_error\', \'loc\': (\'body\', \'time\'), \'msg\': \'Value error, Time must be in HH:MM format (24-hour)\', \'input\': \'25:99\', \'ctx\': {\'error\': ValueError(\'Time must be in HH:MM format (24-hour)\')}}, {\'type\': \'int_parsing\', \'loc\': (\'body\', \'category_id\'), \'msg\': \'Input should be a valid integer, unable to parse string as an integer\', \'input\': \'not_an_integer\'}, {\'type\': \'enum\', \'loc\': (\'body\', \'mode\'), \'msg\': "Input should be \'personal\', \'work\' or \'both\'", \'input\': \'invalid_mode\', \'ctx\': {\'expected\': "\'personal\', \'work\' or \'both\'"}}]\n', 'user_id': None, 'additional_context': {'error_category': 'validation', 'validation_errors': [{'type': 'string_type', 'loc': ('body', 'title'), 'msg': 'Input should be a valid string', 'input': 123}, {'type': 'datetime_from_date_parsing', 'loc': ('body', 'start_date'), 'msg': 'Input should be a valid datetime or date, invalid character in year', 'input': 'not_a_date', 'ctx': {'error': 'invalid character in year'}}, {'type': 'value_error', 'loc': ('body', 'time'), 'msg': 'Value error, Time must be in HH:MM format (24-hour)', 'input': '25:99', 'ctx': {'error': ValueError('Time must be in HH:MM format (24-hour)')}}, {'type': 'int_parsing', 'loc': ('body', 'category_id'), 'msg': 'Input should be a valid integer, unable to parse string as an integer', 'input': 'not_an_integer'}, {'type': 'enum', 'loc': ('body', 'mode'), 'msg': "Input should be 'personal', 'work' or 'both'", 'input': 'invalid_mode', 'ctx': {'expected': "'personal', 'work' or 'both'"}}]}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/activities', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '116', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:51:11,269 - error_handlers - ERROR - Detailed error logged: {'error_id': 'c595b548', 'timestamp': '2025-06-05T18:51:11.264972', 'error_type': 'OperationalError', 'error_message': '(sqlite3.OperationalError) no such table: activities\n[SQL: SELECT activities.id AS activities_id, activities.title AS activities_title, activities.start_date AS activities_start_date, activities.time AS activities_time, activities.category_id AS activities_category_id, activities.repeat_mode AS activities_repeat_mode, activities.end_date AS activities_end_date, activities.days_of_week AS activities_days_of_week, activities.day_of_month AS activities_day_of_month, activities.notes AS activities_notes, activities.mode AS activities_mode \nFROM activities \nWHERE activities.id = ?\n LIMIT ? OFFSET ?]\n[parameters: (99999, 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: activities\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 1063, in get_activity\n    activity = db.query(Activity).filter(Activity.id == activity_id).first()\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: activities\n[SQL: SELECT activities.id AS activities_id, activities.title AS activities_title, activities.start_date AS activities_start_date, activities.time AS activities_time, activities.category_id AS activities_category_id, activities.repeat_mode AS activities_repeat_mode, activities.end_date AS activities_end_date, activities.days_of_week AS activities_days_of_week, activities.day_of_month AS activities_day_of_month, activities.notes AS activities_notes, activities.mode AS activities_mode \nFROM activities \nWHERE activities.id = ?\n LIMIT ? OFFSET ?]\n[parameters: (99999, 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected'}}
2025-06-05 18:51:11,281 - error_handlers - ERROR - Detailed error logged: {'error_id': '5ad914e3', 'timestamp': '2025-06-05T18:51:11.277789', 'error_type': 'TypeError', 'error_message': "handle_database_error() got an unexpected keyword argument 'additional_context'", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: users\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 692, in create_user\n    existing_user = db.query(User).filter(User.username.ilike(user.username)).first()\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.name AS users_name, users.username AS users_username, users.hashed_password AS users_hashed_password, users.is_admin AS users_is_admin \nFROM users \nWHERE lower(users.username) LIKE lower(?)\n LIMIT ? OFFSET ?]\n[parameters: (\'testuser123\', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__\n    await self.app(scope, receive, _send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 736, in app\n    await route.handle(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/to_thread.py", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/Afarie-Backend/main.py", line 716, in create_user\n    return handle_database_error(e, additional_context={"operation": "create_user"})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: handle_database_error() got an unexpected keyword argument \'additional_context\'\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected', 'error_type': 'TypeError'}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '97', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:51:11,295 - error_handlers - ERROR - Detailed error logged: {'error_id': 'ed340d18', 'timestamp': '2025-06-05T18:51:11.292075', 'error_type': 'TypeError', 'error_message': "handle_database_error() got an unexpected keyword argument 'additional_context'", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: users\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 692, in create_user\n    existing_user = db.query(User).filter(User.username.ilike(user.username)).first()\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.name AS users_name, users.username AS users_username, users.hashed_password AS users_hashed_password, users.is_admin AS users_is_admin \nFROM users \nWHERE lower(users.username) LIKE lower(?)\n LIMIT ? OFFSET ?]\n[parameters: (\'testuser123\', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__\n    await self.app(scope, receive, _send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 736, in app\n    await route.handle(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/to_thread.py", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/Afarie-Backend/main.py", line 716, in create_user\n    return handle_database_error(e, additional_context={"operation": "create_user"})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: handle_database_error() got an unexpected keyword argument \'additional_context\'\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected', 'error_type': 'TypeError'}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '101', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:51:11,311 - error_handlers - ERROR - Detailed error logged: {'error_id': 'dea3c265', 'timestamp': '2025-06-05T18:51:11.305267', 'error_type': 'TypeError', 'error_message': "handle_database_error() got an unexpected keyword argument 'additional_context'", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: users\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 777, in change_password\n    user = db.query(User).filter(User.id == user_id).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.name AS users_name, users.username AS users_username, users.hashed_password AS users_hashed_password, users.is_admin AS users_is_admin \nFROM users \nWHERE users.id = ?\n LIMIT ? OFFSET ?]\n[parameters: (1, 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__\n    await self.app(scope, receive, _send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 736, in app\n    await route.handle(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/to_thread.py", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/Afarie-Backend/main.py", line 801, in change_password\n    return handle_database_error(e, additional_context={"operation": "change_password", "user_id": user_id})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: handle_database_error() got an unexpected keyword argument \'additional_context\'\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected', 'error_type': 'TypeError'}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users/1/change-password', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '74', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:51:11,329 - error_handlers - ERROR - Detailed error logged: {'error_id': 'a94edfe7', 'timestamp': '2025-06-05T18:51:11.328878', 'error_type': 'RequestValidationError', 'error_message': "[{'type': 'string_too_long', 'loc': ('body', 'name'), 'msg': 'String should have at most 100 characters', 'input': 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA', 'ctx': {'max_length': 100}}]", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 346, in app\n    raise validation_error\nfastapi.exceptions.RequestValidationError: [{\'type\': \'string_too_long\', \'loc\': (\'body\', \'name\'), \'msg\': \'String should have at most 100 characters\', \'input\': \'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\', \'ctx\': {\'max_length\': 100}}]\n', 'user_id': None, 'additional_context': {'error_category': 'validation', 'validation_errors': [{'type': 'string_too_long', 'loc': ('body', 'name'), 'msg': 'String should have at most 100 characters', 'input': 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA', 'ctx': {'max_length': 100}}]}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '1080', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:51:11,339 - error_handlers - ERROR - Detailed error logged: {'error_id': '0dd0b210', 'timestamp': '2025-06-05T18:51:11.337352', 'error_type': 'TypeError', 'error_message': "handle_database_error() got an unexpected keyword argument 'additional_context'", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: categories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 967, in create_activity\n    category = db.query(Category).filter(Category.id == activity.category_id).first()\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: categories\n[SQL: SELECT categories.id AS categories_id, categories.name AS categories_name, categories.icon_name AS categories_icon_name, categories.mode AS categories_mode \nFROM categories \nWHERE categories.id = ?\n LIMIT ? OFFSET ?]\n[parameters: (99999, 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__\n    await self.app(scope, receive, _send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 736, in app\n    await route.handle(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/to_thread.py", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/Afarie-Backend/main.py", line 1054, in create_activity\n    return handle_database_error(e, additional_context={"operation": "create_activity"})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: handle_database_error() got an unexpected keyword argument \'additional_context\'\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected', 'error_type': 'TypeError'}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/activities', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '165', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:57:15,956 - error_handlers - ERROR - Detailed error logged: {'error_id': '53f02504', 'timestamp': '2025-06-05T18:57:15.955476+00:00', 'error_type': 'RequestValidationError', 'error_message': '[{\'type\': \'value_error\', \'loc\': (\'body\', \'username\'), \'msg\': \'Value error, Username can only contain letters, numbers, underscores, and hyphens\', \'input\': "\'; DROP TABLE users; --", \'ctx\': {\'error\': ValueError(\'Username can only contain letters, numbers, underscores, and hyphens\')}}, {\'type\': \'string_too_short\', \'loc\': (\'body\', \'password\'), \'msg\': \'String should have at least 8 characters\', \'input\': \'weak\', \'ctx\': {\'min_length\': 8}}, {\'type\': \'bool_parsing\', \'loc\': (\'body\', \'is_admin\'), \'msg\': \'Input should be a valid boolean, unable to interpret input\', \'input\': \'not_a_boolean\'}]', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 346, in app\n    raise validation_error\nfastapi.exceptions.RequestValidationError: [{\'type\': \'value_error\', \'loc\': (\'body\', \'username\'), \'msg\': \'Value error, Username can only contain letters, numbers, underscores, and hyphens\', \'input\': "\'; DROP TABLE users; --", \'ctx\': {\'error\': ValueError(\'Username can only contain letters, numbers, underscores, and hyphens\')}}, {\'type\': \'string_too_short\', \'loc\': (\'body\', \'password\'), \'msg\': \'String should have at least 8 characters\', \'input\': \'weak\', \'ctx\': {\'min_length\': 8}}, {\'type\': \'bool_parsing\', \'loc\': (\'body\', \'is_admin\'), \'msg\': \'Input should be a valid boolean, unable to interpret input\', \'input\': \'not_a_boolean\'}]\n', 'user_id': None, 'additional_context': {'error_category': 'validation', 'validation_errors': [{'type': 'value_error', 'loc': ('body', 'username'), 'msg': 'Value error, Username can only contain letters, numbers, underscores, and hyphens', 'input': "'; DROP TABLE users; --", 'ctx': {'error': ValueError('Username can only contain letters, numbers, underscores, and hyphens')}}, {'type': 'string_too_short', 'loc': ('body', 'password'), 'msg': 'String should have at least 8 characters', 'input': 'weak', 'ctx': {'min_length': 8}}, {'type': 'bool_parsing', 'loc': ('body', 'is_admin'), 'msg': 'Input should be a valid boolean, unable to interpret input', 'input': 'not_a_boolean'}]}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '129', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:57:15,967 - error_handlers - ERROR - Detailed error logged: {'error_id': 'bc3cac4c', 'timestamp': '2025-06-05T18:57:15.966471+00:00', 'error_type': 'RequestValidationError', 'error_message': '[{\'type\': \'string_type\', \'loc\': (\'body\', \'title\'), \'msg\': \'Input should be a valid string\', \'input\': 123}, {\'type\': \'datetime_from_date_parsing\', \'loc\': (\'body\', \'start_date\'), \'msg\': \'Input should be a valid datetime or date, invalid character in year\', \'input\': \'not_a_date\', \'ctx\': {\'error\': \'invalid character in year\'}}, {\'type\': \'value_error\', \'loc\': (\'body\', \'time\'), \'msg\': \'Value error, Time must be in HH:MM format (24-hour)\', \'input\': \'25:99\', \'ctx\': {\'error\': ValueError(\'Time must be in HH:MM format (24-hour)\')}}, {\'type\': \'int_parsing\', \'loc\': (\'body\', \'category_id\'), \'msg\': \'Input should be a valid integer, unable to parse string as an integer\', \'input\': \'not_an_integer\'}, {\'type\': \'enum\', \'loc\': (\'body\', \'mode\'), \'msg\': "Input should be \'personal\', \'work\' or \'both\'", \'input\': \'invalid_mode\', \'ctx\': {\'expected\': "\'personal\', \'work\' or \'both\'"}}]', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 346, in app\n    raise validation_error\nfastapi.exceptions.RequestValidationError: [{\'type\': \'string_type\', \'loc\': (\'body\', \'title\'), \'msg\': \'Input should be a valid string\', \'input\': 123}, {\'type\': \'datetime_from_date_parsing\', \'loc\': (\'body\', \'start_date\'), \'msg\': \'Input should be a valid datetime or date, invalid character in year\', \'input\': \'not_a_date\', \'ctx\': {\'error\': \'invalid character in year\'}}, {\'type\': \'value_error\', \'loc\': (\'body\', \'time\'), \'msg\': \'Value error, Time must be in HH:MM format (24-hour)\', \'input\': \'25:99\', \'ctx\': {\'error\': ValueError(\'Time must be in HH:MM format (24-hour)\')}}, {\'type\': \'int_parsing\', \'loc\': (\'body\', \'category_id\'), \'msg\': \'Input should be a valid integer, unable to parse string as an integer\', \'input\': \'not_an_integer\'}, {\'type\': \'enum\', \'loc\': (\'body\', \'mode\'), \'msg\': "Input should be \'personal\', \'work\' or \'both\'", \'input\': \'invalid_mode\', \'ctx\': {\'expected\': "\'personal\', \'work\' or \'both\'"}}]\n', 'user_id': None, 'additional_context': {'error_category': 'validation', 'validation_errors': [{'type': 'string_type', 'loc': ('body', 'title'), 'msg': 'Input should be a valid string', 'input': 123}, {'type': 'datetime_from_date_parsing', 'loc': ('body', 'start_date'), 'msg': 'Input should be a valid datetime or date, invalid character in year', 'input': 'not_a_date', 'ctx': {'error': 'invalid character in year'}}, {'type': 'value_error', 'loc': ('body', 'time'), 'msg': 'Value error, Time must be in HH:MM format (24-hour)', 'input': '25:99', 'ctx': {'error': ValueError('Time must be in HH:MM format (24-hour)')}}, {'type': 'int_parsing', 'loc': ('body', 'category_id'), 'msg': 'Input should be a valid integer, unable to parse string as an integer', 'input': 'not_an_integer'}, {'type': 'enum', 'loc': ('body', 'mode'), 'msg': "Input should be 'personal', 'work' or 'both'", 'input': 'invalid_mode', 'ctx': {'expected': "'personal', 'work' or 'both'"}}]}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/activities', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '116', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:57:16,091 - error_handlers - ERROR - Detailed error logged: {'error_id': '49e98c1a', 'timestamp': '2025-06-05T18:57:16.067019+00:00', 'error_type': 'OperationalError', 'error_message': '(sqlite3.OperationalError) no such table: activities\n[SQL: SELECT activities.id AS activities_id, activities.title AS activities_title, activities.start_date AS activities_start_date, activities.time AS activities_time, activities.category_id AS activities_category_id, activities.repeat_mode AS activities_repeat_mode, activities.end_date AS activities_end_date, activities.days_of_week AS activities_days_of_week, activities.day_of_month AS activities_day_of_month, activities.notes AS activities_notes, activities.mode AS activities_mode \nFROM activities \nWHERE activities.id = ?\n LIMIT ? OFFSET ?]\n[parameters: (99999, 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: activities\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 1063, in get_activity\n    activity = db.query(Activity).filter(Activity.id == activity_id).first()\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: activities\n[SQL: SELECT activities.id AS activities_id, activities.title AS activities_title, activities.start_date AS activities_start_date, activities.time AS activities_time, activities.category_id AS activities_category_id, activities.repeat_mode AS activities_repeat_mode, activities.end_date AS activities_end_date, activities.days_of_week AS activities_days_of_week, activities.day_of_month AS activities_day_of_month, activities.notes AS activities_notes, activities.mode AS activities_mode \nFROM activities \nWHERE activities.id = ?\n LIMIT ? OFFSET ?]\n[parameters: (99999, 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected'}}
2025-06-05 18:57:16,176 - error_handlers - ERROR - Detailed error logged: {'error_id': '30e8b7e4', 'timestamp': '2025-06-05T18:57:16.159541+00:00', 'error_type': 'TypeError', 'error_message': "handle_database_error() got an unexpected keyword argument 'additional_context'", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: users\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 692, in create_user\n    existing_user = db.query(User).filter(User.username.ilike(user.username)).first()\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.name AS users_name, users.username AS users_username, users.hashed_password AS users_hashed_password, users.is_admin AS users_is_admin \nFROM users \nWHERE lower(users.username) LIKE lower(?)\n LIMIT ? OFFSET ?]\n[parameters: (\'testuser123\', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__\n    await self.app(scope, receive, _send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 736, in app\n    await route.handle(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/to_thread.py", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/Afarie-Backend/main.py", line 716, in create_user\n    return handle_database_error(e, additional_context={"operation": "create_user"})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: handle_database_error() got an unexpected keyword argument \'additional_context\'\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected', 'error_type': 'TypeError'}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '97', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:57:16,238 - error_handlers - ERROR - Detailed error logged: {'error_id': '5ee28b54', 'timestamp': '2025-06-05T18:57:16.231174+00:00', 'error_type': 'TypeError', 'error_message': "handle_database_error() got an unexpected keyword argument 'additional_context'", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: users\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 692, in create_user\n    existing_user = db.query(User).filter(User.username.ilike(user.username)).first()\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.name AS users_name, users.username AS users_username, users.hashed_password AS users_hashed_password, users.is_admin AS users_is_admin \nFROM users \nWHERE lower(users.username) LIKE lower(?)\n LIMIT ? OFFSET ?]\n[parameters: (\'testuser123\', 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__\n    await self.app(scope, receive, _send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 736, in app\n    await route.handle(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/to_thread.py", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/Afarie-Backend/main.py", line 716, in create_user\n    return handle_database_error(e, additional_context={"operation": "create_user"})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: handle_database_error() got an unexpected keyword argument \'additional_context\'\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected', 'error_type': 'TypeError'}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '101', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:57:16,303 - error_handlers - ERROR - Detailed error logged: {'error_id': '22c2a810', 'timestamp': '2025-06-05T18:57:16.294085+00:00', 'error_type': 'TypeError', 'error_message': "handle_database_error() got an unexpected keyword argument 'additional_context'", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: users\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 777, in change_password\n    user = db.query(User).filter(User.id == user_id).first()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: users\n[SQL: SELECT users.id AS users_id, users.name AS users_name, users.username AS users_username, users.hashed_password AS users_hashed_password, users.is_admin AS users_is_admin \nFROM users \nWHERE users.id = ?\n LIMIT ? OFFSET ?]\n[parameters: (1, 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__\n    await self.app(scope, receive, _send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 736, in app\n    await route.handle(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/to_thread.py", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/Afarie-Backend/main.py", line 801, in change_password\n    return handle_database_error(e, additional_context={"operation": "change_password", "user_id": user_id})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: handle_database_error() got an unexpected keyword argument \'additional_context\'\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected', 'error_type': 'TypeError'}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users/1/change-password', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '74', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:57:16,379 - error_handlers - ERROR - Detailed error logged: {'error_id': 'f464cc06', 'timestamp': '2025-06-05T18:57:16.379073+00:00', 'error_type': 'RequestValidationError', 'error_message': "[{'type': 'string_too_long', 'loc': ('body', 'name'), 'msg': 'String should have at most 100 characters', 'input': 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA', 'ctx': {'max_length': 100}}]", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 346, in app\n    raise validation_error\nfastapi.exceptions.RequestValidationError: [{\'type\': \'string_too_long\', \'loc\': (\'body\', \'name\'), \'msg\': \'String should have at most 100 characters\', \'input\': \'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\', \'ctx\': {\'max_length\': 100}}]\n', 'user_id': None, 'additional_context': {'error_category': 'validation', 'validation_errors': [{'type': 'string_too_long', 'loc': ('body', 'name'), 'msg': 'String should have at most 100 characters', 'input': 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA', 'ctx': {'max_length': 100}}]}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/users', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '1080', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
2025-06-05 18:57:16,418 - error_handlers - ERROR - Detailed error logged: {'error_id': '46adfd36', 'timestamp': '2025-06-05T18:57:16.407502+00:00', 'error_type': 'TypeError', 'error_message': "handle_database_error() got an unexpected keyword argument 'additional_context'", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlite3.OperationalError: no such table: categories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/workspaces/Afarie-Backend/main.py", line 967, in create_activity\n    category = db.query(Category).filter(Category.id == activity.category_id).first()\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2759, in first\n    return self.limit(1)._iter().first()  # type: ignore\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/query.py", line 2857, in _iter\n    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(\n                                                  ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2365, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute\n    return meth(\n           ^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context\n    self._handle_dbapi_exception(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context\n    self.dialect.do_execute(\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: categories\n[SQL: SELECT categories.id AS categories_id, categories.name AS categories_name, categories.icon_name AS categories_icon_name, categories.mode AS categories_mode \nFROM categories \nWHERE categories.id = ?\n LIMIT ? OFFSET ?]\n[parameters: (99999, 1, 0)]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__\n    await self.app(scope, receive, _send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 736, in app\n    await route.handle(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle\n    await self.app(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 78, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app\n    raise exc\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/routing.py", line 75, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/fastapi/routing.py", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/python/3.12.1/lib/python3.12/site-packages/starlette/concurrency.py", line 38, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/to_thread.py", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 2470, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File "/home/codespace/.local/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 967, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/Afarie-Backend/main.py", line 1054, in create_activity\n    return handle_database_error(e, additional_context={"operation": "create_activity"})\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: handle_database_error() got an unexpected keyword argument \'additional_context\'\n', 'user_id': None, 'additional_context': {'error_category': 'unexpected', 'error_type': 'TypeError'}, 'request_method': 'POST', 'request_url': 'http://localhost:10242/activities', 'request_headers': {'host': 'localhost:10242', 'user-agent': 'python-requests/2.32.3', 'accept-encoding': 'gzip, deflate', 'accept': '*/*', 'connection': 'keep-alive', 'content-length': '165', 'content-type': 'application/json'}, 'client_ip': '127.0.0.1'}
